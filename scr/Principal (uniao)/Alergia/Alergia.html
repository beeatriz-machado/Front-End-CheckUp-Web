<!-- Conferir campos de label e input -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Marcar Consulta</title>

    <!-- Importação de arquivos -->
    <script src="Alergia.js"></script>
    <link rel="stylesheet" href="Alergia.css">
    <script src="../../Otimizar/CarregaConteudoHtml.js"></script>
    <!-- <link rel="stylesheet" href="../../Otimizar/NavigationLeft.html"> -->

     <!-- <link rel="stylesheet" href="../Medicamentos/Medicamento.html"}> -->


    <script>
          // Carregando os arquivos HTML
    loadHTML('header-container', '../../Otimizar/NavigationTop.html');
    loadHTML('content-container', '../../Otimizar/NavigationLeft.html');
    // loadHTML('footer-container', 'footer.html');

    // const cors = require('cors');
    //   app.use(cors()); // Permite todas as origens
      // Função para enviar os dados de alergia para a API
      function cadastrarAlergia() {
        const NomeAlergia = document.getElementsByName('NomeAlergia')[0].value;
        const DataDignosticoAlergia = document.getElementsByName('DataDignosticoAlergia')[0].value;
        const ObservacaoAlergia = document.getElementsByName('ObservacaoAlergia')[0].value;
  
        // Validação simples
        if (!NomeAlergia || !DataDignosticoAlergia || !ObservacaoAlergia) {
          alert('Por favor, preencha todos os campos!');
          return;
        }
  
        const dados = {
          NomeAlergia: NomeAlergia,
          DataDignosticoAlergia: DataDignosticoAlergia,
          ObservacaoAlergia: ObservacaoAlergia
        };
  
        fetch('https://localhost:7001/api/CadastrarAlergia', {  // Substitua pela URL correta da API
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            // 'Authorization': 'Bearer <seu-token-aqui>'  // Se necessário
          },
          body: JSON.stringify(dados)
        })
        .then(response => response.json())
        .then(data => {
          alert('Alergia cadastrada com sucesso!');
          document.getElementsByName('NomeAlergia')[0].value = '';
          document.getElementsByName('DataDignosticoAlergia')[0].value = '';
          document.getElementsByName('ObservacaoAlergia')[0].value = '';
        })
        .catch(error => {
          console.error('Erro ao cadastrar alergia:', error);
          alert('Erro ao cadastrar alergia');
        });
      }


    </script>


</head>

<body>

    <!-- --------- Divs para armazenar Navigations --------- -->
    <div id="header-container"></div>
    <div id="content-container"></div>
    <!-- <div id="footer-container"></div> -->

    <!-- --------- Divs para armazenar Navigations --------- -->

    

    <div class="box-table">

      <form onsubmit="event.preventDefault(); cadastrarAlergia();" name="fPessoas">

        <div id="dfPessoas" class="container">

          <!-- <form onsubmit="event.preventDefault(); cadastrarAlergia();" name="fPessoas"> -->
            <div class="box-label">
              <label class="label-tabela">Tipo de alergia</label>
              <label class="label-tabela">Data</label>
              <label class="label-tabela">Observações</label>
            </div>
            
            <div class="box-input">
              <input type="text" name="NomeAlergia" id="NomeAlergia" class="input-tabela" required>
              <input type="datetime-local" name="DataDignosticoAlergia" id="DataDignosticoAlergia" class="input-tabela" required>
              <input type="text" name="ObservacaoAlergia" id="ObservacaoAlergia" class="input-tabela" required>
            </div>
        
            <!-- <button type="submit" onclick="cadastrarAlergia()">Cadastrar Alergia</button> -->
          <!-- </form> -->

        </div>


        <button type="submit" class="button-event" onclick="cadastrarAlergia()">Salvar</button>

      </form>


    </div>






</body>
</html>